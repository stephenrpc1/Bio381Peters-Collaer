---
title: "Homework 9"
author: "Stephen Peters-Collaer"
date: "3/20/2022"
output: html_document
---
Click [here](index.html) to return to the main page
Question 1
```{r, Question 1}
# Description ------------------
# A script that simulates data for my yellow birch regeneration project.  This script creates simulated data based on the real parameters from my dataset and then runs a linear model and graphs the results.  The independent variable is the size of the fallen over root mounds that the yellow brich are growing on and the dependent variable is the density of yellow birch seedlings growing on the root mound.

#  20 Mar 2022
#SPC

# Initialize -------------------
library(tidyverse)
library(ggplot2)
#set.seed(100)

#library(TeachingDemos)
# char2seed("espresso withdrawal")
# char2seed("espresso withdrawal", set = FALSE)

# Load Functions ---------------

# FUNCTION:create_data
# purpose: Create simulated data for linear model using known parameters from my data
# input: lm data parameters -  slope
# output: A data frame containing the simulated data set based on the given parameters
# ------------------------
create_data <- function(slope = runif(1), n = 10, mean = 50, sd = 10, intercept = 0) {
  noise <- rnorm(n = n, mean = 0, sd = 2)
  x_val  <- rnorm(n = n, mean = mean, sd = sd)
  y_val <- slope*x_val + noise + intercept
  df <- data.frame(x_val, y_val)
  
  return(df)
}


##########################
# FUNCTION:run_model
# purpose: Use x and y vectors to create a linear model
# input:x and y vectors of the same length 
# output: A summary of the results from a linear model run on these vectors
# ------------------------
run_model <- function(x= NULL, y = NULL) {
  if(is.null(x)) print("No Data!") else
  lm1 <- lm(x ~ y)
  summary(lm1)
}

##########################
# FUNCTION:graph_results
# purpose: Graph the simulated data
# input: x and y vectors of the same length that can be graphed in a scatterplot
# output: A scatterplot of the two given vectors
# ------------------------
graph_results <- function(x_var=runif(10), y_var=runif(10)) {
  d_frame <- data.frame(x_var, y_var)
  reg_plot <- ggplot(data = d_frame) +
    aes(x=x_var, y=y_var) +
    geom_point() +
    stat_smooth(method=lm, se=0.95)
  print(reg_plot)
  message("regression data plotted")
  #ggsave(filename="reg_plot.pdf",
   #      plot=reg_plot,
    #     device="pdf")
}


# Global Variables -------------
df1 <- create_data(slope=2.5, n=20, mean=1.8, sd=0.7)

# Program Body -----------------
run_model(x = df1$x_val, y = df1$y_val)

graph_results(x_var = df1$x_val, y_var = df1$y_val)

```

**Question 2**
```{r, Question 2}




```
